---
title: "monkeypox_daily_analysis"
author: "opio bethle"
date: "2025-08-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load libraries
library(dplyr)
library(ggplot2)
library(zoo)
library(lubridate)
library(knitr)
library(DT)
```

## Introduction

This report presents an epidemiological analysis of monkeypox cases using publicly available daily case data. The objective is to explore trends in confirmed cases over time, identify the most affected countries, and examine demographic and clinical characteristics of the reported cases, including gender distribution, hospitalization status, and travel history. The dataset contains thousands of case records collected from multiple global sources, including national health ministries and international health agencies.
Through data cleaning, summarization, and visualization, the report aims to highlight key insights that may inform disease monitoring and response strategies.

```{r}
## Data Cleaning and Daily Case Counts
df <- read.csv("~/monkeypox.csv", stringsAsFactors = FALSE)

# Convert Date_confirmation to proper Date
df$Date_confirmation <- dmy(df$Date_confirmation)

# Remove rows without a confirmation date and duplicates
df_clean <- df %>% 
  filter(!is.na(Date_confirmation)) %>%
  distinct()

# Show first 10 rows
kable(head(df_clean, 10), caption = "First 10 Rows of the Cleaned Monkeypox Dataset")


# Create daily case counts
daily_cases <- df_clean %>%
  group_by(Date_confirmation) %>%
  summarise(Cases = n()) %>%
  arrange(Date_confirmation)

# Plot daily cases
ggplot(daily_cases, aes(x = Date_confirmation, y = Cases)) +
  geom_line(color = "red") +
  labs(title = "Daily Confirmed Monkeypox Cases",
       x = "Date of Confirmation",
       y = "Number of Cases") +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# 7-day moving average
daily_cases <- daily_cases %>%
  mutate(Cases_MA7 = rollmean(Cases, k = 7, fill = NA))

ggplot(daily_cases, aes(x = Date_confirmation)) +
  geom_line(aes(y = Cases), color = "red", alpha = 0.5) +
  geom_line(aes(y = Cases_MA7), color = "blue", size = 1) +
  labs(title = "Daily Confirmed Monkeypox Cases with 7-Day Moving Average",
       x = "Date of Confirmation",
       y = "Number of Cases") +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```


```{r}
# Count cases by country
country_cases <- df_clean %>%
  group_by(Country) %>%
  summarise(Total_Cases = n()) %>%
  arrange(desc(Total_Cases))

# Show summary table
kable(head(daily_cases, 10), caption = "First 10 Days of Reported Cases")

# View top 10 countries
head(country_cases, 10)

# Bar plot of top 10 countries
top_countries <- head(country_cases, 10)
ggplot(top_countries, aes(x = reorder(Country, Total_Cases), y = Total_Cases)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +
  labs(title = "Top 10 Countries by Confirmed Monkeypox Cases",
       x = "Country", y = "Number of Cases") +
  theme_minimal()

# Count by gender
gender_cases <- df_clean %>%
  filter(Gender != "") %>%
  mutate(Gender = tolower(trimws(Gender))) %>%  # Make lowercase and trim spaces
  filter(Gender %in% c("male", "female")) %>%   # Keep only valid values
  group_by(Gender) %>%
  summarise(Total_Cases = n()) %>%
  arrange(desc(Total_Cases))

# Table
kable(gender_cases, caption = "Distribution of Cases by Gender")

# Pie chart
ggplot(gender_cases, aes(x = "", y = Total_Cases, fill = Gender)) +
  geom_col() +
  coord_polar(theta = "y") +
  labs(title = "Distribution of Monkeypox Cases by Gender") +
  theme_void()

# Count hospitalizations
hospital_cases <- df_clean %>%
  filter(Hospitalised..Y.N.NA. %in% c("Y","N")) %>%
  group_by(Hospitalised..Y.N.NA.) %>%
  summarise(Total_Cases = n())

# Table
kable(hospital_cases, caption = "Hospitalization Status of Cases")

# Bar plot
ggplot(hospital_cases, aes(x = Hospitalised..Y.N.NA., y = Total_Cases, fill = Hospitalised..Y.N.NA.)) +
  geom_bar(stat="identity") +
  labs(title="Hospitalization Status of Cases", x="Hospitalized", y="Number of Cases") +
  scale_fill_manual(values = c("Y"="red","N"="green")) +
  theme_minimal()

# Count travel history
travel_cases <- df_clean %>%
  filter(Travel_history..Y.N.NA. %in% c("Y","N")) %>%
  group_by(Travel_history..Y.N.NA.) %>%
  summarise(Total_Cases = n())

# Table
kable(travel_cases, caption = "Travel History Status of Cases")

# Bar plot
ggplot(travel_cases, aes(x = Travel_history..Y.N.NA., y = Total_Cases, fill = Travel_history..Y.N.NA.)) +
  geom_bar(stat="identity") +
  labs(title="Travel History of Cases", x="Travel History", y="Number of Cases") +
  scale_fill_manual(values = c("Y"="orange","N"="purple")) +
  theme_minimal()

```

## Conclusion

This report analyzed the daily trends and characteristics of monkeypox cases. The top 10 affected countries were identified, along with patterns in gender distribution, hospitalization rates, and travel history. These insights can help guide public health responses and resource allocation.
